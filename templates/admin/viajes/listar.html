{% extends "base_admin.html" %}
{% block content %}
<link rel="stylesheet" href="{{ url_for('static', filename='crud_viajes.css') }}">

<h2>Catálogo de Viajes</h2>
<a href="{{ url_for('nuevo_viaje') }}" class="btn" style="margin-bottom:18px;">Nuevo Viaje</a>

<div class="viajes-grid">
  {% for v in viajes %}
  <div class="viaje-card">
    {% if v.imagen %}
      <img src="{{ url_for('static', filename='img/' ~ v.imagen) }}" alt="Imagen de {{ v.nombre }}">
    {% else %}
      <img src="https://via.placeholder.com/400x180?text=Sin+imagen" alt="Sin imagen">
    {% endif %}
    {# Badge de descuento simulado #}
    {% if v.precio and v.precio|float < 10000000 %}
      <div class="badge-descuento">-10%</div>
    {% endif %}
    <div class="viaje-card-body">
      <div class="viaje-card-title">{{ v.nombre }}</div>
      <div class="viaje-card-info">
        {% if v.fecha %}<span>{{ v.fecha }}</span>{% endif %}
        <span>{{ v.descripcion|truncate(50) }}</span>
      </div>
      <div class="viaje-card-precio">
        {% if v.precio %}
          $ {{ v.precio }}
        {% else %}
          Consultar
        {% endif %}
      </div>
      <div class="viaje-card-btns">
        <a class="btn-crud" href="{{ url_for('detalle_viaje', id=v.id) }}">Ver más</a>
        {% if current_user.is_authenticated and current_user.rol == 'admin' %}
          <a href="{{ url_for('editar_viaje', id=v.id) }}" class="btn-crud">Editar</a>
        {% endif %}
        <form action="{{ url_for('eliminar_viaje', id=v.id) }}" method="post" style="display:inline;">
        {% if current_user.is_authenticated and current_user.rol == 'admin' %}  
          <button class="btn-crud btn-crud-outline" type="submit" onclick="return confirm('¿Eliminar viaje?')">Eliminar</button>
        {% endif %}
        </form>
      </div>
    </div>
  </div>
  {% endfor %}
</div>
{% endblock %}
